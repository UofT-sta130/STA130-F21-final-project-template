"0","detective_data_1 <- detective_data %>% 
  left_join(word_counts_text, by = ""story_code"") %>% 
  mutate(title_words = str_count(story_name)+1) %>% 
  mutate(before_reveal_words = if_else(is.na(after_reveal_words), NaN, before_reveal_words)) %>% 
  select(-where(function(x) all(is.na(x)))) %>% 
  mutate(date_of_first_publication_yyyy_mm_dd = as_date(date_of_first_publication_yyyy_mm_dd),
         year_of_birth = as_date(year_of_birth),
         date_of_death_yyyy_mm_dd = as_date(date_of_death_yyyy_mm_dd)) %>% 
  mutate(unique = unique(story_code))
"
"2","Error: Problem with `mutate()` column `unique`.
[34mâ„¹[39m `unique = unique(story_code)`.
[34mâ„¹[39m `unique` must be size 355 or 1, not 351.
[90mRun `rlang::last_error()` to see where the error occurred.[39m
"
